from datetime import datetime, timezone
from unittest import TestCase

class MGraph__RSS__Test_Data(TestCase):

    def test_rss_data(self):
        return { 'channel': { 'description': 'Most trusted, widely-read independent '
                              'cybersecurity news source for everyone; '
                              'supported by hackers and IT professionals — '
                              'Send TIPs to admin@thehackernews.com',
               'extensions': {},
               'image': None,
               'items': [ { 'categories': [],
                            'content': {},
                            'creator': 'None',
                            'description': 'Despite significant investments in '
                                           'advanced technologies and employee '
                                           'training programs, credential and '
                                           'user-based attacks remain '
                                           'alarmingly prevalent, accounting '
                                           'for 50-80% of enterprise '
                                           'breaches[1],[2]. While '
                                           'identity-based attacks continue to '
                                           'dominate as the leading cause of '
                                           'security incidents, the common '
                                           'approach to identity security '
                                           'threats is still threat reduction, '
                                           'implementing layers of',
                            'enclosure': None,
                            'extensions': { 'author': 'info@thehackernews.com '
                                                      '(The Hacker News)',
                                            'enclosure': { 'length': '12216320',
                                                           'type': 'image/jpeg',
                                                           'url': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj_3x9HdMLRcpTgBXvmIV5SWLzAPDZbmRgvsM6wHaXAX9DT1fcORSs3eaWYYKdZj6RXYgwtgN8BrHhc8jjvhWz3dcsNREaGZp_eUhdD7yib1LdOSaGVIsd_d_BaxEWGnJDx1_EkUzfIwo2q0XjwnVldj8WY8qpqJlQRDG3P2XK0sWwMQWVHZFQmWCEXT4w/s1600/Identity-Security.png'}},
                            'guid': '210e7780-4768-527d-93ee-276194515fa0',
                            'link': 'https://thehackernews.com/2025/01/eliminate-identity-based-threats.html',
                            'pub_date': { 'date_time_utc': '2025-01-23 '
                                                           '11:20:00 +0000',
                                          'date_utc': '2025-01-23',
                                          'raw_value': 'Thu, 23 Jan 2025 '
                                                       '16:50:00 +0530',
                                          'time_since': '1 hour(s) ago',
                                          'time_utc': '11:20',
                                          'timestamp_utc': 1737631200},
                            'thumbnail': {},
                            'title': 'How to Eliminate Identity-Based Threats'},
                          { 'categories': [],
                            'content': {},
                            'creator': 'None',
                            'description': 'SonicWall is alerting customers of '
                                           'a critical security flaw impacting '
                                           'its Secure Mobile Access (SMA) '
                                           '1000 Series appliances that it '
                                           'said has been likely exploited in '
                                           'the wild as a zero-day.\n'
                                           'The vulnerability, tracked as '
                                           'CVE-2025-23006, is rated 9.8 out '
                                           'of a maximum of 10.0 on the CVSS '
                                           'scoring system.\n'
                                           '"Pre-authentication '
                                           'deserialization of untrusted data '
                                           'vulnerability has been identified '
                                           'in the',
                            'enclosure': None,
                            'extensions': { 'author': 'info@thehackernews.com '
                                                      '(The Hacker News)',
                                            'enclosure': { 'length': '12216320',
                                                           'type': 'image/jpeg',
                                                           'url': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg9G0w1_XRyjir28xDf1OQe39RpuJViL0jb88xm3-yavFkAH_LzFLMQLs1wdbdd-qJIPogh7m5sAqdzyxdhxV2Jtlhj8KtE-MgNgkcehYo9hAN94cnwfp51QQp_Yy_KSBcvvI2_LS3b7VarcG_xs_-nsgIiYafDbOF0K-LugCeebsRXdUziSb3Qt_0wfRCy/s1600/sonic.jpg'}},
                            'guid': '8af85e68-4bce-55a1-ab78-f810847965cb',
                            'link': 'https://thehackernews.com/2025/01/sonicwall-urges-immediate-patch-for.html',
                            'pub_date': { 'date_time_utc': '2025-01-23 '
                                                           '10:24:00 +0000',
                                          'date_utc': '2025-01-23',
                                          'raw_value': 'Thu, 23 Jan 2025 '
                                                       '15:54:00 +0530',
                                          'time_since': '2 hour(s) ago',
                                          'time_utc': '10:24',
                                          'timestamp_utc': 1737627840},
                            'thumbnail': {},
                            'title': 'SonicWall Urges Immediate Patch for '
                                     'Critical CVE-2025-23006 Flaw Amid Likely '
                                     'Exploitation'},
                          { 'categories': [],
                            'content': {},
                            'creator': 'None',
                            'description': 'Are your websites leaking '
                                           'sensitive data? New research '
                                           'reveals that 45% of third-party '
                                           'apps access user info without '
                                           'proper authorization, and 53% of '
                                           'risk exposures in Retail are due '
                                           'to the excessive use of tracking '
                                           'tools. Learn how to uncover and '
                                           'mitigate these hidden threats and '
                                           'risks—download the full report '
                                           'here.\n'
                                           'New research by web exposure '
                                           'management specialist Reflectiz '
                                           'reveals several',
                            'enclosure': None,
                            'extensions': { 'author': 'info@thehackernews.com '
                                                      '(The Hacker News)',
                                            'enclosure': { 'length': '12216320',
                                                           'type': 'image/jpeg',
                                                           'url': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg9PqSC2JRc65xTSsboeUU7ySrbr12XEKIK4O4iUvD87hYysGKfuFjPO53VBN8tep6EOybWFuJ_NnCkN__8vdRRDIvDpQzzpLF03X3y9FDE1fnuXCu_TkwKEgpbWb1bvFbMnr_8iLL0o0NAl-yByAAsnw5GhZv462y_KG6uKQhh1b72mf5-kH1H7V7Ei6M/s1600/web.png'}},
                            'guid': '27fd0ed4-5995-52c9-81d0-9c47d7268e32',
                            'link': 'https://thehackernews.com/2025/01/new-research-state-of-web-exposure-2025.html',
                            'pub_date': { 'date_time_utc': '2025-01-23 '
                                                           '10:15:00 +0000',
                                          'date_utc': '2025-01-23',
                                          'raw_value': 'Thu, 23 Jan 2025 '
                                                       '15:45:00 +0530',
                                          'time_since': '2 hour(s) ago',
                                          'time_utc': '10:15',
                                          'timestamp_utc': 1737627300},
                            'thumbnail': {},
                            'title': 'New Research: The State of Web Exposure '
                                     '2025'}],
               'language': 'en-us',
               'last_build_date': { 'date_time_utc': '2025-01-23 11:52:40 '
                                                     '+0000',
                                    'date_utc': '2025-01-23',
                                    'raw_value': 'Thu, 23 Jan 2025 17:22:40 '
                                                 '+0530',
                                    'time_since': '1 hour(s) ago',
                                    'time_utc': '11:52',
                                    'timestamp_utc': 1737633160},
               'link': 'https://thehackernews.com',
               'title': 'The Hacker News',
               'update_frequency': '1',
               'update_period': 'hourly'},
  'extensions': {},
  'namespaces': {},
  'version': '2.0'}
        return {
            'channel': {
                'description': 'Test RSS Feed - Security News and Updates',
                'extensions': {},
                'image': None,
                'items': [
                    {
                        'categories': ['security', 'identity'],
                        'content': {},
                        'creator': 'test_author',
                        'description': 'Test article about identity security and threats.',
                        'enclosure': None,
                        'extensions': {
                            'author': 'test@example.com (Test Author)',
                            'enclosure': {
                                'length': '10000',
                                'type': 'image/jpeg',
                                'url': 'https://test.com/images/article1.jpg'
                            }
                        },
                        'guid': 'test-guid-001',
                        'link': 'https://test.com/article1',
                        'pub_date': {
                            'date_time_utc': '2025-01-23 11:20:00 +0000',
                            'date_utc': '2025-01-23',
                            'raw_value': 'Thu, 23 Jan 2025 11:20:00 +0000',
                            'time_since': '1 hour(s) ago',
                            'time_utc': '11:20',
                            'timestamp_utc': 1737631200
                        },
                        'thumbnail': {},
                        'title': 'Test Article 1: Identity Security'
                    },
                    {
                        'categories': ['vulnerability', 'security'],
                        'content': {},
                        'creator': 'test_author',
                        'description': 'Critical security vulnerability discovered.',
                        'enclosure': None,
                        'extensions': {
                            'author': 'test@example.com (Test Author)',
                            'enclosure': {
                                'length': '10000',
                                'type': 'image/jpeg',
                                'url': 'https://test.com/images/article2.jpg'
                            }
                        },
                        'guid': 'test-guid-002',
                        'link': 'https://test.com/article2',
                        'pub_date': {
                            'date_time_utc': '2025-01-23 10:24:00 +0000',
                            'date_utc': '2025-01-23',
                            'raw_value': 'Thu, 23 Jan 2025 10:24:00 +0000',
                            'time_since': '2 hour(s) ago',
                            'time_utc': '10:24',
                            'timestamp_utc': 1737627840
                        },
                        'thumbnail': {},
                        'title': 'Test Article 2: Security Vulnerability'
                    }
                ],
                'language': 'en-us',
                'last_build_date': {
                    'date_time_utc': '2025-01-23 11:52:40 +0000',
                    'date_utc': '2025-01-23',
                    'raw_value': 'Thu, 23 Jan 2025 11:52:40 +0000',
                    'time_since': '1 hour(s) ago',
                    'time_utc': '11:52',
                    'timestamp_utc': 1737633160
                },
                'link': 'https://test.com',
                'title': 'Test RSS Feed',
                'update_frequency': '1',
                'update_period': 'hourly'
            },
            'extensions': {},
            'namespaces': {},
            'version': '2.0'
        }

    # Helper function to create test item
    def create_test_item(self, guid, title, description, categories, timestamp):
        return {
            'categories': categories,
            'content': {},
            'creator': 'test_author',
            'description': description,
            'enclosure': None,
            'extensions': {
                'author': 'test@example.com (Test Author)',
                'enclosure': {
                    'length': '10000',
                    'type': 'image/jpeg',
                    'url': f'https://test.com/images/{guid}.jpg'
                }
            },
            'guid': guid,
            'link': f'https://test.com/{guid}',
            'pub_date': {
                'date_time_utc': datetime.fromtimestamp(timestamp, tz=timezone.utc).strftime('%Y-%m-%d %H:%M:%S +0000'),
                'date_utc': datetime.fromtimestamp(timestamp, tz=timezone.utc).strftime('%Y-%m-%d'),
                'raw_value': datetime.fromtimestamp(timestamp, tz=timezone.utc).strftime('%a, %d %b %Y %H:%M:%S +0000'),
                'time_since': '1 hour(s) ago',
                'time_utc': datetime.fromtimestamp(timestamp, tz=timezone.utc).strftime('%H:%M'),
                'timestamp_utc': timestamp
            },
            'thumbnail': {},
            'title': title
        }